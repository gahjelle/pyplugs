version: 2

shared: &shared
    working_directory: ~/circleci-pyplugs
    steps:
      - checkout
      - run:
          name: Install
          command: |
            python -m pip install flit --user
            python -m flit install --deps=develop

jobs:
  "python-3.6":
    <<: *shared
    docker:
      - image: circleci/python:3.6

    steps:
      - run:
          name: Test
          command: |
            python -m tox -e py36


  "python-3.7":
    <<: *shared
    docker:
      - image: circleci/python:3.7

    steps:
      - run:
          name: Test
          command: |
            python -m tox -e py37 black mypy


workflows:
  version: 2

  development-workflow:
    jobs:
      - "python3.6"
      - "python3.7"
